单下划线开头（_name）和双下划线开头（__name）是 Python 的命名约定，用来表达不同的可见性和用途，简要说明如下：

单下划线开头（_foo）

约定：表示“内部实现/受保护”（internal / protected），提醒使用者这是内部方法或属性，不属于公共 API。
行为：只是约定，不会被语言强制隐藏；from module import * 默认不会导入以单下划线开头的名字。
用例：像 _buy_at、_sell_at、_aggregate_actions 在类内作为辅助/私有实现函数。
双下划线开头（__foo）

约定：用于避免子类意外覆盖（name mangling）。
行为：Python 会把 __foo 重命名为 _ClassName__foo（名称改写），用于实现弱私有性。
注意：一般不推荐滥用，除非确实需要在子类中避免名称冲突。
前后双下划线（init、str 等）

这是“魔法方法”（special / dunder methods），由 Python 解释器识别并有特定语义，不应随意定义成其他用途。
单下划线作为变量（_）

习惯上表示“临时/忽略的变量”。
对外接口建议

公共 API 使用无下划线命名，便于用户调用和文档化。
内部辅助方法用单下划线前缀，表明可用但不保证兼容性或稳定性。
总结：下划线是以约定为主的可视化信号，提醒使用者哪些成员是内部实现（单下划线）或需要避免在子类中重名（双下划线）。在你的 VirtualManager 中使用 buy_at/sell_at 表示它们是内部帮助方法，而 get_summary/run 等无下划线的方法则是对外稳定接口。